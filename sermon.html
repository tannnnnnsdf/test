<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡πÄ‡∏ó‡∏®‡∏ô‡∏≤</title>

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&family=Anuphan:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">

<meta property="og:title" content="">
<meta property="og:description" content="‡∏Ñ‡∏≥‡πÄ‡∏ó‡∏®‡∏ô‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏à‡∏±‡∏Å‡∏£">
<meta property="og:image" content="">
<meta property="og:url" content="">
</head>
<body>

<div class="reader">

  <div class="reader-toolbar">
    <button onclick="fontSmaller()">A‚àí</button>
    <button onclick="fontBigger()">A+</button>
    <button onclick="toggleDark()">üåô</button>

    <button class="btn line" onclick="shareLine()">LINE</button>
    <button class="btn fb" onclick="shareFacebook()">Facebook</button>
    <button class="btn share" onclick="shareNative()">‡πÅ‡∏ä‡∏£‡πå</button>
    <button class="btn print" onclick="downloadPDF()">PDF</button>
  </div>

  <article class="reader-content">
    <h1 id="title"></h1>
    <p id="meta"></p>
    <div id="content" class="sermon-content">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‚Ä¶</div>
  </article>

</div>

<script>
const p = new URLSearchParams(location.search);
const title = p.get("title") || "";
const date = p.get("date") || "";
const preacher = p.get("preacher") || "";
const doc = p.get("doc") || "";
const youtube = p.get("youtube") || "";

document.getElementById("title").textContent = title;
document.getElementById("meta").textContent = date + " ‚Ä¢ " + preacher;

// OG TAG
document.querySelector('meta[property="og:title"]').content = title;
document.querySelector('meta[property="og:url"]').content = window.location.href;

if (youtube) {
  const m = youtube.match(/(youtu\.be\/|v=)([^&]+)/);
  if (m && m[2]) {
    document.querySelector('meta[property="og:image"]').content =
      `https://img.youtube.com/vi/${m[2]}/hqdefault.jpg`;
  }
}

// FETCH GOOGLE DOC CONTENT
fetch(doc + "?embedded=true")
  .then(res => res.text())
  .then(html => {
    const dom = new DOMParser().parseFromString(html, "text/html");
    const body = dom.querySelector(".doc-content") || dom.body;
    document.getElementById("content").innerHTML = body.innerHTML;
  })
  .catch(() => {
    document.getElementById("content").textContent = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏î‡πâ";
  });

/* FONT SIZE */
let fontSize = 1.05;
function fontBigger() {
  fontSize += 0.1;
  document.documentElement.style.fontSize = fontSize + "rem";
}
function fontSmaller() {
  fontSize = Math.max(0.9, fontSize - 0.1);
  document.documentElement.style.fontSize = fontSize + "rem";
}

/* DARK MODE */
function toggleDark() {
  document.body.classList.toggle("dark");
}

/* SHARE */
function shareLine() {
  const url = encodeURIComponent(window.location.href);
  window.open(`https://social-plugins.line.me/lineit/share?url=${url}`, "_blank");
}
function shareFacebook() {
  const url = encodeURIComponent(window.location.href);
  window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, "_blank");
}
function shareNative() {
  if (navigator.share) {
    navigator.share({ title, text: title, url: window.location.href });
  } else {
    shareLine();
  }
}

/* PDF */
function downloadPDF() {
  window.print();
}
</script>

</body>
</html>
