<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>อ่านคำเทศนา</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="reader">
  <article class="reader-content">
    <h1 id="title"></h1>
    <p id="meta"></p>
    <div id="content" class="sermon-content">กำลังโหลดเนื้อหา…</div>
  </article>
</div>

<script>
const p=new URLSearchParams(location.search);
title.textContent=p.get("title")||"";
meta.textContent=(p.get("date")||"")+" • "+(p.get("preacher")||"");

const doc=p.get("doc");

fetch(doc + "?embedded=true")
.then(r=>r.text())
.then(html=>{
  const dom=new DOMParser().parseFromString(html,"text/html");

  const root =
    dom.querySelector("#contents") ||
    dom.querySelector(".doc-content") ||
    dom.body;

  root.querySelectorAll(
    "script,style,nav,header,footer,form,input,button,textarea,select"
  ).forEach(e=>e.remove());

  root.querySelectorAll("[style]").forEach(e=>{
    e.style.maxWidth="100%";
    e.style.whiteSpace="normal";
  });

  document.getElementById("content").innerHTML = root.innerHTML;
})
.catch(()=>{
  document.getElementById("content").textContent="โหลดเนื้อหาไม่สำเร็จ";
});
</script>

</body>
</html>
